{% liquid
  assign c = "RelatedProductOptions"
  assign option = option
  assign related_products = related_products
  assign current_product = current_product
  assign product_collection = product_collection | default: false

  assign option_name = option.name | downcase
  assign is_box_material = false
  if option_name == 'box material'
    assign is_box_material = true
  endif
%}

<div
  class="{{c}}"
  data-component="{{c}}"
>
  <div class="{{c}}__header">
    <div class="{{c}}__title subheader">
      {% render 'product-option-name',
        option_name: option.name
      %}:
    </div>

    <div class="{{c}}__selected-value subheader">
      {{ option.selected_value }}

      {% unless current_product.available %}
        (sold out)
      {% endunless %}
    </div>
  </div>

  <div class="{{c}}__values-container js-valuesContainer">
    <div class="{{c}}__values js-valuesWrap">
      {%
        render 'related-product-option',
        product: current_product
        title: option.selected_value,
        url: current_product.url,
        current_url: current_product.url,
        product_images: current_product.images,
        is_box_material: is_box_material,
        product_collection: product_collection,
      %}

      {% for product in related_products %}
        {% if product.available and product.url != current_product.url %} 
          {%
            render 'related-product-option',
            product: product,
            title: product.selected_or_first_available_variant.option1,
            url: product.url,
            current_url: current_product.url,
            product_images: product.images,
            is_box_material: is_box_material,
            product_collection: product_collection,
          %}
        {% endif %}
      {% endfor %}

      {% for product in related_products %}
        {% unless product.available or product.url == current_product.url %} 
          {%
            render 'related-product-option',
            product: product,
            title: product.selected_or_first_available_variant.option1,
            url: product.url,
            current_url: current_product.url,
            product_images: product.images,
            is_box_material: is_box_material,
            product_collection: product_collection,
          %}
        {% endunless %}
      {% endfor %}
    </div>

    <button
      class="{{c}}__view-more-btn js-showMoreBtn js-relatedProductsDrawerToggle"
      aria-label="View more {{ option.name }} options"
    >
      <span class="caption">
        More Options
      </span>

      {%
        render 'component-icon',
        icon: 'chevron-icon'
      %}
    </button>
  </div>
</div>
